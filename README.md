


[<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36" version="26.1.1">
  <diagram name="페이지-1" id="pOsH9RVspttnuCngmtYo">
    <mxGraphModel dx="400" dy="565" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="9W6NtZwpuSmbqSNwthoX-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-1" target="9W6NtZwpuSmbqSNwthoX-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-1" value="회원가입" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="40" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-2" target="9W6NtZwpuSmbqSNwthoX-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-2" value="DB" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="1">
          <mxGeometry x="720" y="260" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-3" value="DB" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="1">
          <mxGeometry x="250" y="40" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-4" target="9W6NtZwpuSmbqSNwthoX-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-4" value="로그인" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="40" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-7" target="9W6NtZwpuSmbqSNwthoX-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-7" value="비밀번호 암호화" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-9" target="9W6NtZwpuSmbqSNwthoX-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-9" value="&lt;font style=&quot;font-size: 11px;&quot;&gt;아이디 비밀번호 이름&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;정보입력&lt;/font&gt;&lt;/div&gt;" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" vertex="1" parent="1">
          <mxGeometry x="65" y="120" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-14" target="9W6NtZwpuSmbqSNwthoX-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-14" target="9W6NtZwpuSmbqSNwthoX-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-14" value="Member객체&lt;div&gt;생성하여 정보 저장&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="280" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-18" value="회원가입 성공" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="360" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-21" target="9W6NtZwpuSmbqSNwthoX-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-21" value="&lt;font style=&quot;font-size: 11px;&quot;&gt;아이디 비밀번호&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 11px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;정보입력&lt;/span&gt;&lt;/div&gt;" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" vertex="1" parent="1">
          <mxGeometry x="505" y="120" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-24" target="9W6NtZwpuSmbqSNwthoX-2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="740" y="220" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-24" value="아이디 비밀번호 검증" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-27" target="9W6NtZwpuSmbqSNwthoX-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-27" value="검증 일치 확인" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="280" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-30" target="9W6NtZwpuSmbqSNwthoX-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-30" value="Access Token&lt;div&gt;Refresh Token 발급&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="360" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9W6NtZwpuSmbqSNwthoX-32" target="9W6NtZwpuSmbqSNwthoX-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-32" value="Access Token&amp;nbsp;&lt;div&gt;클라이언트에게 반환&lt;/div&gt;&lt;div&gt;Refresh Token&lt;/div&gt;&lt;div&gt;쿠키저장&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="440" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9W6NtZwpuSmbqSNwthoX-35" value="로그인 완료" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="560" width="120" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
Uploading login.drawio…]()


### **1. 회원가입 과정**

회원가입 과정은 사용자가 자신의 정보를 제공하고, 이를 시스템에 저장하여 인증을 위한 토큰을 발급받을 수 있도록 합니다.

### **1.1. 사용자 정보 입력 (회원가입)**

- 사용자는 **아이디**, **비밀번호**, **이름** 등의 정보를 입력하여 회원가입을 시도합니다.
- 클라이언트는 이러한 정보를 **POST** 요청으로 서버에 보냅니다.

### **1.2. 비밀번호 암호화**

- 서버에서 받은 **비밀번호**는 암호화하여 저장해야 합니다.
- Spring Security와 같은 라이브러리를 사용하여 **BCrypt** 방식으로 비밀번호를 암호화합니다.
- 이렇게 암호화된 비밀번호는 **데이터베이스**에 저장됩니다.

### **1.3. 사용자 정보 저장**

- **Member** 객체를 생성하여, 사용자가 입력한 정보를 저장합니다.
- 데이터베이스에 **Member** 객체를 저장하여 사용자 정보를 관리합니다.

### **1.4. 성공적인 회원가입 응답**

- 회원가입이 성공하면, 서버는 성공 메시지를 클라이언트에게 반환합니다. 예를 들어:
    - `회원가입 성공`
    - HTTP 상태 코드 **201 CREATED**

---

### **2. 로그인 과정**

로그인 과정은 사용자가 입력한 **아이디**와 **비밀번호**로 인증을 받고, 인증된 사용자에게 **Access Token**과 **Refresh Token**을 발급하는 과정입니다.

### **2.1. 사용자 아이디와 비밀번호 입력**

- 사용자는 로그인 화면에서 **아이디**와 **비밀번호**를 입력합니다.
- 클라이언트는 이 정보를 **POST** 요청으로 서버에 전달합니다.

### **2.2. 아이디와 비밀번호 검증**

- 서버는 받은 **아이디**를 **데이터베이스**에서 검색하여, 해당 사용자가 존재하는지 확인합니다.
- 사용자가 존재하면, 입력된 **비밀번호**와 **데이터베이스에 저장된 비밀번호**를 비교하여 일치하는지 확인합니다.
    - **비밀번호** 비교는 **BCrypt** 라이브러리를 통해 암호화된 비밀번호를 비교하는 방식으로 처리됩니다.

### **2.3. 토큰 발급**

- **아이디**와 **비밀번호**가 일치하면, 사용자는 인증에 성공하고, 서버는 **Access Token**과 **Refresh Token**을 발급합니다.
    - **Access Token**은 사용자가 인증된 요청을 보낼 수 있도록 합니다. 일반적으로 **짧은 유효 기간** (예: 1시간)을 설정합니다.
    - **Refresh Token**은 Access Token이 만료되었을 때, 새로운 Access Token을 발급받기 위해 사용됩니다. **긴 유효 기간** (예: 7일)으로 설정됩니다.

### **2.4. 토큰 반환**

- 발급된 **Access Token**은 **Authorization** 헤더에 포함되어 클라이언트에게 반환됩니다.
- **Refresh Token**은 **쿠키**에 저장되어, 클라이언트가 이후 요청에서 이를 사용할 수 있도록 합니다.

---

### **3. 토큰을 사용한 인증과 권한 관리**

### **3.1. 인증된 요청**

- 클라이언트는 **Access Token**을 HTTP 요청의 **Authorization** 헤더에 포함시켜 서버로 보냅니다.
- 서버는 **Access Token**을 검증하여 요청이 인증된 사용자의 것인지 확인합니다.

### **3.2. Access Token 만료 시**

- **Access Token**이 만료되면, 클라이언트는 **Refresh Token**을 사용하여 새로운 **Access Token**을 발급받을 수 있습니다.
    - `/refresh-token` API를 호출하여 **Refresh Token**을 서버로 보내면, 서버는 해당 **Refresh Token**을 검증하고, 유효하면 새로운 **Access Token**과 **Refresh Token**을 발급합니다.
    - 새로운 **Access Token**은 **Authorization** 헤더에 포함되어 응답으로 반환되고, 새로운 **Refresh Token**은 **쿠키**에 저장됩니다.

---

### **4. 로그아웃 과정**

### **4.1. 로그아웃 요청**

- 사용자가 로그아웃을 요청하면, 클라이언트는 **POST** 방식으로 `/logout` API에 요청을 보냅니다.

### **4.2. 쿠키와 세션 삭제**

- 서버는 클라이언트에게 전달된 **Refresh Token**을 **쿠키**에서 삭제합니다.
- 클라이언트는 이후 로그인을 다시 해야만 새로운 **Access Token**과 **Refresh Token**을 발급받을 수 있습니다.

---

### **5. 회원가입, 로그인, 로그아웃 API 흐름**

1. **회원가입**:
    - 클라이언트는 회원가입 정보를 **POST** 방식으로 서버에 전송합니다.
    - 서버는 받은 정보를 암호화하여 **데이터베이스**에 저장하고, 성공 응답을 보냅니다.
2. **로그인**:
    - 클라이언트는 **아이디**와 **비밀번호**를 **POST** 방식으로 서버에 보냅니다.
    - 서버는 **아이디**와 **비밀번호**를 검증하고, 유효하면 **Access Token**과 **Refresh Token**을 발급하여 클라이언트에게 반환합니다.
3. **인증된 요청**:
    - 클라이언트는 **Access Token**을 **Authorization** 헤더에 포함시켜 API 요청을 보냅니다.
    - 서버는 **Access Token**을 검증하고, 인증된 요청인지 확인한 후 응답을 반환합니다.
4. **Refresh Token을 이용한 Access Token 갱신**:
    - **Access Token**이 만료되면, 클라이언트는 **Refresh Token**을 서버로 보내어 새로운 **Access Token**을 요청합니다.
    - 서버는 **Refresh Token**을 검증하고, 새로운 **Access Token**과 **Refresh Token**을 발급하여 클라이언트에게 반환합니다.
5. **로그아웃**:
    - 클라이언트는 로그아웃을 요청하고, 서버는 **Refresh Token**을 쿠키에서 삭제하여 사용자가 인증되지 않은 상태로 만듭니다.

---

### **요약**

- **회원가입**: 사용자가 정보를 제공하고, 서버는 이를 암호화하여 데이터베이스에 저장합니다.
- **로그인**: 사용자가 **아이디**와 **비밀번호**로 인증을 받으며, **Access Token**과 **Refresh Token**을 발급받습니다.
- **Access Token**과 **Refresh Token**은 인증을 유지하는 핵심 요소로, **Access Token**은 짧은 유효 기간을, **Refresh Token**은 긴 유효 기간을 가집니다.
- **Refresh Token**을 사용하여 만료된 **Access Token**을 갱신할 수 있습니다.
- **로그아웃** 시에는 **Refresh Token**이 쿠키에서 삭제되어, 사용자는 인증 상태를 유지할 수 없습니다.
